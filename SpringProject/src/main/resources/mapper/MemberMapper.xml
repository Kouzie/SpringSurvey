<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="org.sist.project.mapper.MemberMapper">
	<select id="selectAdminList" resultType="MemberVO">
		SELECT tbl_member.member_seq, username, password, enabled, name, birth, gender, image
		FROM tbl_member
		JOIN tbl_auth ON tbl_member.member_seq = tbl_auth.member_seq
		WHERE tbl_auth.authority = 'ROLE_ADMIN'
	</select>
	<insert id="insertMember">
		INSERT INTO tbl_member (member_seq, username, password, name, birth, gender, image) VALUES
		(seq_member.nextval, #{username}, #{password}, #{name}, #{birth}, #{gender}, #{image, jdbcType=VARCHAR})
		<!-- null처리를 위해 타입 명시 -->
	</insert>
	<delete id="deleteMember">
		DELETE FROM tbl_member WHERE member_seq = #{ member_seq }
	</delete>
	<select id="selectUserById" resultType="MemberDetails">
        <![CDATA[
            SELECT tbl_member.*, tbl_auth.authority
            FROM tbl_member
            JOIN tbl_auth ON tbl_member.member_seq = tbl_auth.member_seq
            WHERE username = #{username}
        ]]>
    </select>
    <select id="selectUsername" resultType="String">
    	SELECT username 
    	FROM tbl_member 
    	WHERE username = #{ username }
    </select>
</mapper>